# Music Board Visualizer - 音乐木板可视化器

## 项目概述
一个基于 Three.js 的音乐可视化应用，模拟"木板钉在墙面"的视角：
- 小球从顶部下落
- 依次落在木板上，碰撞时激活木板颜色
- 小球沿木板弧度转向，滑向下一块木板
- 每块木板对应一个音符/节拍
- 支持歌词显示
- 最终可录制为视频

## 技术栈
- Three.js（3D 渲染）
- Web Audio API（音频播放和同步）
- Vite（构建工具）
- TypeScript
- CCapture.js 或 MediaRecorder（视频录制）

## 核心功能要求

### 1. 场景设置
- 俯视视角，模拟木板钉在墙面上的效果
- 紫蓝色渐变背景，带光效
- 相机跟随小球缓慢下移

### 2. 木板系统
- 木板是 3D 长方体，有厚度感，像真实木板钉在墙上
- 木板默认暗色，被小球碰到后亮起（颜色渐变，带发光效果）
- 木板有不同角度，引导小球转向
- 木板位置由音符数据驱动：音高→水平位置，时间→垂直位置

### 3. 小球动画
- 小球在木板之间走抛物线（模拟重力下落）
- 碰到木板后沿木板表面短暂滑动，然后弹出
- 转向使用贝塞尔曲线，看起来平滑自然
- 小球带拖尾/粒子效果

### 4. 音乐同步
- 读取预定义的节拍数据（JSON 格式）
- 节拍数据格式：[{time: 秒, pitch: MIDI音高, duration: 秒, lyric?: "歌词"}, ...]
- 小球碰撞时间与音乐节拍精确同步

### 5. 歌词显示
- 在对应木板附近显示歌词文字
- 文字随碰撞淡入，带发光效果

### 6. Demo 数据
- 提供一个内置的 demo 节拍数据（可以是简单的音阶或旋律）
- 不需要真实音频文件，先用节拍数据驱动动画即可

## 项目结构建议
```
src/
  main.ts          - 入口
  scene.ts         - Three.js 场景设置
  board.ts         - 木板类
  ball.ts          - 小球类（含路径计算）
  layout.ts        - 木板布局算法
  music-data.ts    - 节拍数据定义和 demo 数据
  lyrics.ts        - 歌词渲染
  effects.ts       - 粒子、光效
  recorder.ts      - 视频录制
  types.ts         - 类型定义
```

## 第一阶段目标
先实现核心 demo：
1. 静态场景 + 几块木板
2. 小球沿预计算路径下落、碰撞、转向
3. 碰撞时木板变色发光
4. 用内置 demo 数据驱动
5. 能在浏览器中运行看到效果

不需要：音频播放、视频录制、歌词（后续加）
